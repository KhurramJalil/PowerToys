<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define ColorPickerResourcesFiles=?>
  <?define ColorPickerResourcesFilesPath=$(var.BinDir)Resources\?>

  <Fragment>
  <!-- Color Picker -->
    <DirectoryRef Id="INSTALLFOLDER">
      <Directory Id="ColorPickerResourcesFolder" Name="Resources"/>
    </DirectoryRef>

    <!-- Refactor into a folder inside Assets -->
    <!-- Color Picker Resources -->
    <DirectoryRef Id="ColorPickerResourcesFolder" FileSource="$(var.ColorPickerResourcesFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--ColorPickerResourcesFiles_Component_Def-->
    </DirectoryRef>

    <ComponentGroup Id="ColorPickerComponentGroup">
      <Component Id="RemoveColorPickerFolder" Guid="18C0C18C-F38A-4C88-B22C-9222F3A5B2EB" Directory="INSTALLFOLDER" >
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveColorPickerFolder" Value="" KeyPath="yes"/>
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderColorPickerResourcesFolder" Directory="ColorPickerResourcesFolder" On="uninstall"/>
      </Component>
    </ComponentGroup>

  </Fragment>
</Wix>
